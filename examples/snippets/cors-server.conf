# CORS-specific server configuration
# This provides server-wide CORS support configuration

# Custom error pages for CORS requests
error_page 403 @cors_forbidden;
error_page 404 @cors_not_found;

# Named locations for CORS error handling
location @cors_forbidden {
    add_header Access-Control-Allow-Origin "*" always;
    add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;
    add_header Content-Type "application/json" always;
    return 403 '{"error": "Forbidden", "message": "CORS policy violation"}';
}

location @cors_not_found {
    add_header Access-Control-Allow-Origin "*" always;
    add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;
    add_header Content-Type "application/json" always;
    return 404 '{"error": "Not Found", "message": "API endpoint not found"}';
}

# Enable gzip for JSON responses
gzip_types application/json text/plain;