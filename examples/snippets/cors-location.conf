# CORS-specific location configuration
# This enhances the basic CORS support with additional headers

# Custom CORS headers for API versioning
add_header X-API-Version "v1.0" always;
add_header X-CORS-Enabled "snippets" always;

# Enhanced caching for CORS preflight requests
proxy_cache_valid 200 302 5m;
proxy_cache_valid 404 1m;
proxy_cache_valid OPTIONS 24h;

# CORS preflight handling
if ($request_method = 'OPTIONS') {
    add_header X-Handled-By "nginx-snippet" always;
    return 204;
}

# API-specific logging
access_log /var/log/nginx/cors_api_access.log main;